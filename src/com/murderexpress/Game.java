package com.murderexpress;

import java.io.Serializable;
import java.util.Scanner;

public class Game {
    public Board board = Board.getInstance();
    private Scanner scanner = new Scanner(System.in);
    boolean isOver = false;
    private StoryLine storyLine;
    private Player player = new Player();
    private String userName;


    public void execute() {
        while (!isOver) {
            welcome();
            chooseStoryId();// choose the story here
            playGame(storyLine);
            showBoard();
            end();
            isOver = true;
        }

    }

    private void welcome() {
        System.out.println("     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà‚ñà                   \n" +
                "   ‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                          ‚ñë‚ñë‚ñà‚ñà‚ñà                    \n" +
                "    ‚ñë‚ñà‚ñà‚ñà‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà \n" +
                "    ‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà\n" +
                "    ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñë  ‚ñë‚ñà‚ñà‚ñà  ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà  ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñë ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñë \n" +
                "    ‚ñë‚ñà‚ñà‚ñà      ‚ñë‚ñà‚ñà‚ñà  ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà  ‚ñë‚ñà‚ñà‚ñà     ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë   ‚ñë‚ñà‚ñà‚ñà     \n" +
                "    ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà    \n" +
                "   ‚ñë‚ñë‚ñë‚ñë‚ñë     ‚ñë‚ñë‚ñë‚ñë‚ñë   ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë ‚ñë‚ñë‚ñë‚ñë‚ñë      ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñë‚ñë‚ñë‚ñë‚ñë     \n" +
                "                                                                  ");
        System.out.println("             ‚ñÑ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÑ   ‚ñÑ‚ñÄ‚ñÄ‚ñÑ ‚ñÄ‚ñÑ      ‚ñÑ‚ñÄ‚ñÄ‚ñÄ‚ñà‚ñÄ‚ñÄ‚ñÑ  ‚ñÑ‚ñÄ‚ñÄ‚ñÑ ‚ñÑ‚ñÑ   ‚ñÑ‚ñÄ‚ñÄ‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ \n" +
                "           ‚ñà      ‚ñà ‚ñà  ‚ñà ‚ñà ‚ñà     ‚ñà    ‚ñà  ‚ñê ‚ñà  ‚ñà   ‚ñÑ‚ñÄ ‚ñê  ‚ñÑ‚ñÄ   ‚ñê \n" +
                "           ‚ñà      ‚ñà ‚ñê  ‚ñà  ‚ñÄ‚ñà     ‚ñê   ‚ñà     ‚ñê  ‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñà    ‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ  \n" +
                "           ‚ñÄ‚ñÑ    ‚ñÑ‚ñÄ   ‚ñà   ‚ñà         ‚ñà         ‚ñà   ‚ñà    ‚ñà    ‚ñå  \n" +
                "             ‚ñÄ‚ñÄ‚ñÄ‚ñÄ   ‚ñÑ‚ñÄ   ‚ñà        ‚ñÑ‚ñÄ         ‚ñÑ‚ñÄ  ‚ñÑ‚ñÄ   ‚ñÑ‚ñÄ‚ñÑ‚ñÑ‚ñÑ‚ñÑ   \n" +
                "                    ‚ñà    ‚ñê       ‚ñà          ‚ñà   ‚ñà     ‚ñà    ‚ñê   \n" +
                "                    ‚ñê            ‚ñê          ‚ñê   ‚ñê     ‚ñê        ");

        System.out.println("  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñÑ‚ñÑ‚ñÑ     ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñà‚ñà‚ñë ‚ñà‚ñà  ‚ñà    ‚ñà‚ñà  ‚ñà‚ñà‚ñÄ‚ñà‚ñà‚ñà  ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ \n" +
                "‚ñì‚ñà‚ñà   ‚ñí ‚ñì‚ñà   ‚ñÄ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñÑ   ‚ñì  ‚ñà‚ñà‚ñí ‚ñì‚ñí‚ñì‚ñà‚ñà‚ñë ‚ñà‚ñà‚ñí ‚ñà‚ñà  ‚ñì‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà ‚ñí ‚ñà‚ñà‚ñí‚ñì‚ñà   ‚ñÄ ‚ñí‚ñà‚ñà‚ñÄ ‚ñà‚ñà‚ñå\n" +
                "‚ñí‚ñà‚ñà‚ñà‚ñà ‚ñë ‚ñí‚ñà‚ñà‚ñà  ‚ñí‚ñà‚ñà  ‚ñÄ‚ñà‚ñÑ ‚ñí ‚ñì‚ñà‚ñà‚ñë ‚ñí‚ñë‚ñí‚ñà‚ñà‚ñÄ‚ñÄ‚ñà‚ñà‚ñë‚ñì‚ñà‚ñà  ‚ñí‚ñà‚ñà‚ñë‚ñì‚ñà‚ñà ‚ñë‚ñÑ‚ñà ‚ñí‚ñí‚ñà‚ñà‚ñà   ‚ñë‚ñà‚ñà   ‚ñà‚ñå\n" +
                "‚ñë‚ñì‚ñà‚ñí  ‚ñë ‚ñí‚ñì‚ñà  ‚ñÑ‚ñë‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñë ‚ñì‚ñà‚ñà‚ñì ‚ñë ‚ñë‚ñì‚ñà ‚ñë‚ñà‚ñà ‚ñì‚ñì‚ñà  ‚ñë‚ñà‚ñà‚ñë‚ñí‚ñà‚ñà‚ñÄ‚ñÄ‚ñà‚ñÑ  ‚ñí‚ñì‚ñà  ‚ñÑ ‚ñë‚ñì‚ñà‚ñÑ   ‚ñå\n" +
                "‚ñë‚ñí‚ñà‚ñë    ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí‚ñì‚ñà   ‚ñì‚ñà‚ñà‚ñí ‚ñí‚ñà‚ñà‚ñí ‚ñë ‚ñë‚ñì‚ñà‚ñí‚ñë‚ñà‚ñà‚ñì‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñà‚ñà‚ñì ‚ñí‚ñà‚ñà‚ñí‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñì \n" +
                " ‚ñí ‚ñë    ‚ñë‚ñë ‚ñí‚ñë ‚ñë‚ñí‚ñí   ‚ñì‚ñí‚ñà‚ñë ‚ñí ‚ñë‚ñë    ‚ñí ‚ñë‚ñë‚ñí‚ñë‚ñí‚ñë‚ñí‚ñì‚ñí ‚ñí ‚ñí ‚ñë ‚ñí‚ñì ‚ñë‚ñí‚ñì‚ñë‚ñë‚ñë ‚ñí‚ñë ‚ñë ‚ñí‚ñí‚ñì  ‚ñí \n" +
                " ‚ñë       ‚ñë ‚ñë  ‚ñë ‚ñí   ‚ñí‚ñí ‚ñë   ‚ñë     ‚ñí ‚ñë‚ñí‚ñë ‚ñë‚ñë‚ñë‚ñí‚ñë ‚ñë ‚ñë   ‚ñë‚ñí ‚ñë ‚ñí‚ñë ‚ñë ‚ñë  ‚ñë ‚ñë ‚ñí  ‚ñí \n" +
                " ‚ñë ‚ñë       ‚ñë    ‚ñë   ‚ñí    ‚ñë       ‚ñë  ‚ñë‚ñë ‚ñë ‚ñë‚ñë‚ñë ‚ñë ‚ñë   ‚ñë‚ñë   ‚ñë    ‚ñë    ‚ñë ‚ñë  ‚ñë \n" +
                "           ‚ñë  ‚ñë     ‚ñë  ‚ñë         ‚ñë  ‚ñë  ‚ñë   ‚ñë        ‚ñë        ‚ñë  ‚ñë   ‚ñë    \n" +
                "                                                                  ‚ñë      ");
        System.out.println("     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                         \n" +
                "   ‚ñë‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà                                                         \n" +
                "    ‚ñë‚ñà‚ñà‚ñà  ‚ñà ‚ñë  ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà \n" +
                "    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñë‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñë‚ñë   ‚ñà‚ñà‚ñà‚ñë‚ñë  \n" +
                "    ‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñà    ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë   ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñë ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà \n" +
                "    ‚ñë‚ñà‚ñà‚ñà ‚ñë   ‚ñà  ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà  ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà     ‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë   ‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà ‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà\n" +
                "    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà \n" +
                "   ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë ‚ñë‚ñë‚ñë‚ñë‚ñë ‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñë‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë  ‚ñë‚ñë‚ñë‚ñë‚ñë      ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  \n" +
                "                           ‚ñë‚ñà‚ñà‚ñà                                        \n" +
                "                           ‚ñà‚ñà‚ñà‚ñà‚ñà                                       \n" +
                "                          ‚ñë‚ñë‚ñë‚ñë‚ñë                                        ");

        System.out.println("                                                                       ");
        System.out.println("                                                                       ");
        System.out.print("Please enter your name: ");
        userName = scanner.nextLine();
        player.setUserName(userName);
        System.out.println();
        System.out.println("\nHello " + player.getUserName() + ", please read this letter to get started.");
        System.out.println();
        System.out.println("         __________________\n" +
                "        |\\                /|\n" +
                "        | \\              / |  \n" +
                "        | /\\____________/\\ |  \n" +
                "        |/                \\|  \n" +
                "        |__________________|  ");
        System.out.println();
        System.out.print("[O]pen: ");
        openLetter();

    }

    private void playGame(StoryLine storyLine) {
        System.out.println(storyLine.getScene1());
        storyLine.getTrivia();
        storyLine.getQuestion();
        storyLine.checkAnswer();

        System.out.println(storyLine.getScene2());
        storyLine.getClue();
        storyLine.getTrivia();
        storyLine.getQuestion();
        storyLine.checkAnswer();

        System.out.println(storyLine.getScene3());
        storyLine.getClue();
        storyLine.getTrivia();
        storyLine.getQuestion();
        storyLine.checkAnswer();

        System.out.println(storyLine.getScene4());
        storyLine.getClue();
        storyLine.getTrivia();
        storyLine.getQuestion();
        storyLine.checkAnswer();
        if (storyLine.canConclude()) {
            storyLine.getConclusion();
            board.update(userName);
        } else {
            board.updateFailed(userName);
        }

    }

    private void openLetter() {
        boolean validInput = false;
        while (!validInput) {
            String input = scanner.nextLine();
            if (input.matches("o|O|open|Open")) {
                System.out.println("   ______________________________\n" +
                        " / \\                             \\.\n" +
                        "|   |  Your goal is to solve the |.\n" +
                        " \\_ |  murder before you run out |.\n" +
                        "    |  of chances.               |.\n" +
                        "    |                            |.\n" +
                        "    |  Please, be careful. The   |.\n" +
                        "    |  killer is out there.      |.\n" +
                        "    |                            |.\n" +
                        "    |  Good Luck!                |.\n" +
                        "    |   _________________________|___\n" +
                        "    |  /                            /.\n" +
                        "    \\_/____________________________/.");
                validInput = true;
            }
        }
    }

    private StoryLine chooseStoryId() {
        int id = 0;
        boolean validInput = false;
        while (!validInput) {
            System.out.println();
            System.out.println();
            System.out.println("    *******************************");
            System.out.println("    *   Choose a story to begin   *");
            System.out.println("    *   [1]       [2]       [3]   *");
            System.out.println("    *    ü¶Ü        ü¶Ü        ü¶Ü    *");
            System.out.println("    *******************************");
            System.out.println();
            System.out.print("Which one will it be? ");
            String input = scanner.nextLine();
            if (input.matches("\\d")) {
                id = Integer.parseInt(input);
                if (id >= 1 && id <= 3) {
                    validInput = true;
                }
            }
        }
        if (id == 1) {
            storyLine = storyLineOne();
        }
        if (id == 2) {
            storyLine = storyLineTwo();
        }
        if (id == 3) {
            storyLine = storyLineThree();
        }
        return storyLine;
    }

    public void updateBoard(String userName) {
        board.update(userName);
    }

    private void showBoard() {
        board.show();
    }

    private void end() {
        System.out.println("\nThank you for playing!");
    }

    private StoryLine storyLineOne() {
        return new StoryLine("\nThe beginning1", "\nthe middle1", "\nmiddle end1", "\nend1");
    }

    private StoryLine storyLineTwo() {
        return new StoryLine("\nThe beginning2", "\nthe middle2", "\nmiddle end2", "\nend2");
    }

    private StoryLine storyLineThree() {
        return new StoryLine("\nThe beginning3", "\nthe middle3", "\nmiddle end3", "\nend3");
    }

}
